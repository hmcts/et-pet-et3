language: ruby
cache:
  bundler: true
  directories:
  - tmp/parallel_runtime_log
before_script:
  - ./bin/dev/docker-support-services up -d
  - ./bin/wait-for-it.sh localhost:9000
  - sleep 5
  - ./bin/wait-for-it.sh localhost:9000
  - bundle exec rake parallel:create parallel:migrate
script:
  - bundle exec rake parallel:spec
addons:
  chrome: stable
  firefox: latest
  postgresql: "9.6"
services:
  - postgresql